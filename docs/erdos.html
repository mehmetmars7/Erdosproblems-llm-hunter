<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-6MVZPMS7X5"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());

        gtag('config', 'G-6MVZPMS7X5');
    </script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Erdos Problems - Problem Hunting with LLMs (beta)</title>
    <link rel="stylesheet" href="styles.css">
    <script>
        window.MathJax = {
            tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']],
                displayMath: [['$$', '$$'], ['\\[', '\\]']],
                processEscapes: true,
                processEnvironments: true,
                tags: 'ams',
                macros: {
                    'R': '{\\mathbb{R}}',
                    'C': '{\\mathbb{C}}',
                    'N': '{\\mathbb{N}}',
                    'Z': '{\\mathbb{Z}}',
                    'Q': '{\\mathbb{Q}}'
                }
            },
            options: {
                skipHtmlTags: ['script', 'noscript', 'style', 'textarea', 'pre']
            }
        };
    </script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
</head>
<body class="list-page">
    <header>
        <h1>Erdos Problems</h1>
        <nav>
            <a href="index.html">Home</a>
            <a href="erdos.html" class="active">Erdos Problems</a>
            <a href="mo.html">MathOverflow</a>
            <a href="about.html">About</a>
            <button type="button" id="theme-toggle" class="theme-toggle" aria-pressed="false">Light</button>
        </nav>
    </header>

    <main>
        <section class="description">
            <p>
                Problems from Paul Erdos, one of the most prolific mathematicians in history.
                For official problem statements and comments, see
                <a href="https://www.erdosproblems.com/">erdosproblems.com</a>.
                For the collaborative database, see
                <a href="https://teorth.github.io/erdosproblems/">Terry Tao's Erdos Problems project</a>.
            </p>
        </section>

        <section class="filters">
            <label for="filter-attacks">
                <input type="checkbox" id="filter-attacks" checked>
                Only show problems with LLM attempts
            </label>
            <label for="search">
                Search: <input type="text" id="search" placeholder="Problem number...">
            </label>
        </section>

        <section class="problems-list">
            <table id="erdos-table">
                <thead>
                    <tr>
                        <th>Problem #</th>
                        <th id="review-header" style="cursor: pointer;" title="Click to sort by review">Community<br>Review ⇅</th>
                        <th>Completion</th>
                        <th id="claim-header" style="cursor: pointer;" title="Click to sort by status">LLM<br>Claim ⇅</th>
                        <th>Models</th>
                        <th>Links</th>
                    </tr>
                </thead>
                <tbody id="erdos-tbody">
                    <tr><td colspan="6">Loading...</td></tr>
                </tbody>
            </table>
        </section>

        <section class="contribute-cta">
            <h3>Contribute</h3>
            <p>
                Have an LLM attempt to share for an Erdos problem?
                See our <a href="https://github.com/mehmetmars7/Erdosproblems-llm-hunter/blob/main/CONTRIBUTING.md" target="_blank">Contributing Guidelines</a>
                to submit your contribution.
            </p>
        </section>
    </main>

    <footer>
        <p>
            <a href="https://github.com/mehmetmars7/Erdosproblems-llm-hunter">GitHub Repository</a> |
            <a href="about.html">About</a> |
            <a href="LICENSE">Apache License 2.0</a>
        </p>
    </footer>

    <script src="data/erdos_data.js"></script>
    <script src="app.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const tbody = document.getElementById('erdos-tbody');
            const filterCheckbox = document.getElementById('filter-attacks');
            const searchInput = document.getElementById('search');
            const claimHeader = document.getElementById('claim-header');
            const reviewHeader = document.getElementById('review-header');
            let sortByStatus = 0; // 0 = by number, 1 = status A-Z, -1 = status Z-A
            let sortByReview = 0; // 0 = by number, 1 = review A-Z, -1 = review Z-A
            
            const hasUnresolved = (attack) => /unresolved/i.test(attack.raw || '');

            // Helper to determine overall status
            const getOverallStatus = (attacks) => {
                if (!attacks || attacks.length === 0) return 'zzz-none'; // Sort last
                return attacks.some(hasUnresolved) ? 'unresolved' : 'solved';
            };

            function renderTable() {
                if (typeof erdosProblems === 'undefined') {
                    tbody.innerHTML = '<tr><td colspan="6">Error loading data</td></tr>';
                    return;
                }

                const filterAttacks = filterCheckbox.checked;
                const searchTerm = searchInput.value.trim();

                let problems = Object.values(erdosProblems);

                // Sort by problem number, review, or status
                if (sortByReview !== 0) {
                    problems.sort((a, b) => {
                        const reviewA = window.ProblemHunting.getReviewLabel(a.review);
                        const reviewB = window.ProblemHunting.getReviewLabel(b.review);
                        return sortByReview * reviewA.localeCompare(reviewB);
                    });
                } else if (sortByStatus !== 0) {
                    problems.sort((a, b) => {
                        const statusA = getOverallStatus(a.attacks);
                        const statusB = getOverallStatus(b.attacks);
                        return sortByStatus * statusA.localeCompare(statusB);
                    });
                } else {
                    problems.sort((a, b) => parseInt(a.number) - parseInt(b.number));
                }

                // Filter
                if (filterAttacks) {
                    problems = problems.filter(p => p.attacks && p.attacks.length > 0);
                }
                if (searchTerm) {
                    problems = problems.filter(p => p.number.includes(searchTerm));
                }

                if (problems.length === 0) {
                    tbody.innerHTML = '<tr><td colspan="6">No problems found</td></tr>';
                    return;
                }

                tbody.innerHTML = problems.map(p => {
                    // Shorten model names and limit to 2, prioritizing GPT Pro
                    const shortenModel = (name) => {
                        if (name.toLowerCase().includes('gpt pro')) return 'GPT Pro';
                        if (name.toLowerCase().includes('gpt 5.2') || name.toLowerCase().includes('gpt_5.2')) return 'GPT 5.2';
                        if (name.toLowerCase().includes('codex')) return 'Codex';
                        if (name.toLowerCase().includes('claude') || name.toLowerCase().includes('opus')) return 'Opus 4.5';
                        if (name.toLowerCase().includes('gemini')) return 'Gemini';
                        return name.split(' ').slice(0, 2).join(' ');
                    };
                    let uniqueModels = [...new Set(p.attacks.map(a => shortenModel(a.model)))];
                    // Prioritize GPT Pro - if present, put it first
                    if (uniqueModels.includes('GPT Pro')) {
                        uniqueModels = ['GPT Pro', ...uniqueModels.filter(m => m !== 'GPT Pro')];
                    }
                    const models = uniqueModels.slice(0, 2).join(', ') || '-';
                    const modelsLabel = models === '-' ? models : models.toLowerCase();

                    // Determine overall status based on the source content.
                    const determineStatus = (attacks) => {
                        if (!attacks || attacks.length === 0) return 'none';
                        return attacks.some(hasUnresolved) ? 'unresolved' : 'solved';
                    };
                    
                    const status = determineStatus(p.attacks);
                    const statusClass = status === 'solved' ? 'table-status-solved' :
                                       status === 'unresolved' ? 'table-status-unresolved' :
                                       '';
                    const reviewLabel = window.ProblemHunting.getReviewLabel(p.review);
                    const reviewClass = window.ProblemHunting.getReviewClass(p.review);
                    const completionLabel = window.ProblemHunting.formatCompletion(p.completion);

                    return `
                        <tr>
                            <td><a href="problem.html?type=erdos&id=${p.number}">#${p.number}</a></td>
                            <td class="${reviewClass}">${reviewLabel}</td>
                            <td>${completionLabel}</td>
                            <td class="${statusClass} claim-status">${status}</td>
                            <td>${modelsLabel}</td>
                            <td>
                                <a href="${p.problem_url}" target="_blank">erdosproblems.com</a> |
                                <a href="${p.database_url}" target="_blank">database</a>
                            </td>
                        </tr>
                    `;
                }).join('');
            }

            // Use debounce from app.js for search input
            const debouncedRender = window.ProblemHunting.debounce(renderTable, 200);

            filterCheckbox.addEventListener('change', renderTable);
            searchInput.addEventListener('input', debouncedRender);
            claimHeader.addEventListener('click', () => {
                // Cycle: default (0) -> A-Z (1) -> Z-A (-1) -> default (0)
                if (sortByStatus === 0) {
                    sortByStatus = 1;
                } else if (sortByStatus === 1) {
                    sortByStatus = -1;
                } else {
                    sortByStatus = 0;
                }
                sortByReview = 0;
                renderTable();
            });
            reviewHeader.addEventListener('click', () => {
                // Cycle: default (0) -> A-Z (1) -> Z-A (-1) -> default (0)
                if (sortByReview === 0) {
                    sortByReview = 1;
                } else if (sortByReview === 1) {
                    sortByReview = -1;
                } else {
                    sortByReview = 0;
                }
                sortByStatus = 0;
                renderTable();
            });
            renderTable();
        });
    </script>
</body>
</html>
